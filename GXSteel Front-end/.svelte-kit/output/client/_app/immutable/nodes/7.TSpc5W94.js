import"../chunks/CWj6FrbW.js";import"../chunks/Ciih1mrX.js";import{o as Ga,s as d}from"../chunks/BrsXXap9.js";import{aj as Ha,ap as Xa,aq as Ya,v as y,al as i,ar as $a,as as h,b as a,w as _,ak as Za,am as s,f as v,m as p,an as t,ao as ka,u as m,at,a as Aa,au as tt}from"../chunks/BSGI3RlU.js";import{i as st,s as it,a as et}from"../chunks/D9amEckC.js";import{e as $,i as k}from"../chunks/CYtQTwf0.js";import{r as rt,s as z}from"../chunks/CIU5LcWC.js";import{s as A}from"../chunks/BQfdN1iM.js";import{e as f,r as lt}from"../chunks/DN4ffuaz.js";import{b as qa}from"../chunks/Cnj_E5dI.js";import{i as nt}from"../chunks/CLfTygMI.js";import{p as ot}from"../chunks/DXh43tuN.js";var ct=y('<button type="button" class="thumbnail-wrapper svelte-q5d10x" style="background-color: transparent;" tabindex="0"><img alt="Thumbnail"/></button>'),dt=y('<i style="cursor: pointer;"></i>'),vt=y("<i></i>"),mt=y('<div class="card mb-3 shadow-sm"><div class="card-body d-flex align-items-start"><img alt="Avatar" class="rounded-circle me-3" style="width: 50px; height: 50px; object-fit: cover;"/> <div><h6 class="mb-1"> </h6> <div class="mb-2"></div> <p class="mb-1"> </p> <small class="text-muted"> </small></div></div></div>'),pt=y('<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.2/font/bootstrap-icons.css"/> <div class="container mt-5"><div class="row"><div class="col-md-6 mb-4"><img alt="Product" class="img-fluid rounded mb-3 product-image svelte-q5d10x"/> <div class="d-flex justify-content-between"></div></div> <div class="col-md-6"><h2 class="mb-3"> </h2> <p class="text-muted mb-4"> </p> <div class="mb-3"><span class="h4 me-2"> </span> <span class="text-muted"><s> </s></span></div> <div class="mb-3"><i class="bi bi-star-fill text-warning"></i> <i class="bi bi-star-fill text-warning"></i> <i class="bi bi-star-fill text-warning"></i> <i class="bi bi-star-fill text-warning"></i> <i class="bi bi-star-half text-warning"></i> <span class="ms-2"> </span></div> <p class="mb-4"> </p> <div class="mb-4"><label for="quantity" class="form-label">Quantidade:</label> <input type="number" class="form-control" id="quantity" min="1" style="width: 80px"/></div> <button class="btn btn-primary btn-lg mb-3 me-2 svelte-q5d10x">Peça agora!</button> <button class="btn btn-outline-secondary btn-lg mb-3 svelte-q5d10x"><i></i> </button> <div class="mt-4"><h5>Principais Características:</h5> <ul><li>Alta resistência e durabilidade</li> <li>Versatilidade para múltiplas aplicações</li> <li>Qualidade certificada</li> <li>Entrega rápida e confiável</li></ul></div></div></div></div> <section class="container py-5"><h2 class="mb-4">Avaliações</h2> <div class="mb-3"><i class="bi bi-star-fill text-warning"></i> <i class="bi bi-star-fill text-warning"></i> <i class="bi bi-star-fill text-warning"></i> <i class="bi bi-star-fill text-warning"></i> <i class="bi bi-star-half text-warning"></i> <span class="ms-2"> </span></div> <div class="card shadow-sm mb-4"><div class="card-body"><h5 class="card-title">Escreva uma avaliação</h5> <form><div class="mb-3"><label for="rating" class="form-label">Avaliação</label> <div class="mb-3 d-flex align-items-center"><!> <span class="ms-2"> </span></div></div> <div class="mb-3"><label for="comment" class="form-label">Comentário</label> <textarea class="form-control" id="comment" rows="3"></textarea></div> <button type="submit" class="btn btn-primary svelte-q5d10x">Enviar Avaliação</button></form></div></div> <!></section>',1);function jt(ja,Ea){Ha(Ea,!1);const[Pa,Ta]=it(),B=()=>et(ot,"$page",Pa),q=p();let l=p([]),g=p([]),w=p(""),G=p([]),H=p(1),j=p(0),X={},b=p(0),E=p(""),u=p(!1);function Y(n){v(w,n)}function Ra(){window.open(`https://api.whatsapp.com/send?phone=+551640424000&text=Olá, gostaria de saber mais sobre o produto: ${a(l).name}`,"_blank")}async function Ua(){const e=await(await fetch(`http://172.16.0.18:3000/api/update_product/${a(q)}`,{method:"PUT",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({comments:[...a(g),{comment:a(E),rating:a(b)}]})})).json();console.log(e)}async function Ca(){const n=`http://172.16.0.18:3000/api/${a(u)?"unlike_product":"like_product"}/${a(l)._id}`,e="PUT";try{const r=await fetch(n,{method:e,credentials:"include"}),c=await r.json();r.ok?(v(u,!a(u)),at(l,a(l).likes=a(u)?(a(l).likes||0)+1:Math.max((a(l).likes||1)-1,0))):console.error(c.error||"Erro ao curtir/descurtir")}catch(r){console.error("Erro:",r)}}Ga(async()=>{const e=await(await fetch(`http://172.16.0.18:3000/api/product/${a(q)}`)).json();v(l,e),v(w,Array.isArray(e.image)?e.image[0]:""),X=e.ratings,v(j,Object.keys(X).length),v(G,Array.isArray(e.image)?[...e.image]:[]),v(g,Array.isArray(e.comments)?[...e.comments]:[]);try{const c=await(await fetch("http://172.16.0.18:3000/api/protected",{credentials:"include"})).json();v(u,c.liked&&c.liked.includes(a(l)._id))}catch{console.warn("Usuário não autenticado ou erro ao buscar favoritos")}}),Xa(()=>B(),()=>{v(q,B().params.id)}),Ya(),nt();var Z=pt(),P=i($a(Z),2),aa=s(P),T=s(aa),ta=s(T),sa=i(ta,2);$(sa,5,()=>a(G),k,(n,e)=>{var r=ct(),c=s(r);t(r),h(()=>{z(c,"src",a(e)),A(c,1,`thumbnail rounded ${a(w)===a(e)?"active":""}`,"svelte-q5d10x")}),f("click",r,()=>Y(a(e))),f("keydown",r,o=>(o.key==="Enter"||o.key===" ")&&Y(a(e))),_(n,r)}),t(sa),t(T);var ia=i(T,2),R=s(ia),Da=s(R,!0);t(R);var U=i(R,2),Oa=s(U);t(U);var C=i(U,2),D=s(C),Sa=s(D);t(D);var ea=i(D,2),ra=s(ea),Fa=s(ra);t(ra),t(ea),t(C);var O=i(C,2),la=i(s(O),10),Ia=s(la);t(la),t(O);var S=i(O,2),La=s(S,!0);t(S);var F=i(S,2),na=i(s(F),2);rt(na),t(F);var oa=i(F,2),I=i(oa,2),ca=s(I),Ma=i(ca);t(I),ka(2),t(ia),t(aa),t(P);var da=i(P,2),L=i(s(da),2),va=i(s(L),10),Qa=s(va);t(va),t(L);var M=i(L,2),ma=s(M),Q=i(s(ma),2),J=s(Q),pa=i(s(J),2),ba=s(pa);$(ba,0,()=>Array(5),k,(n,e,r)=>{var c=dt();let o;h(x=>o=A(c,1,"bi fs-4 me-1",null,o,x),[()=>({"bi-star-fill":r<a(b),"bi-star":r>=a(b),"text-warning":r<a(b),"text-muted":r>=a(b)})],Aa),f("click",c,()=>v(b,r+1)),_(n,c)});var ua=i(ba,2),Ja=s(ua);t(ua),t(pa),t(J);var _a=i(J,2),fa=i(s(_a),2);lt(fa),t(_a),ka(2),t(Q),t(ma),t(M);var Ka=i(M,2);{var Na=n=>{var e=tt(),r=$a(e);$(r,1,()=>a(g),k,(c,o)=>{var x=mt(),ga=s(x),xa=s(ga),ha=i(xa,2),K=s(ha),Va=s(K,!0);t(K);var N=i(K,2);$(N,4,()=>Array(5),k,(W,bt,Ba)=>{var wa=vt();h(()=>A(wa,1,`bi ${a(o),m(()=>Ba<a(o).rating?"bi-star-fill text-warning":"bi-star text-muted")??""}`)),_(W,wa)}),t(N);var V=i(N,2),Wa=s(V,!0);t(V);var ya=i(V,2),za=s(ya,!0);t(ya),t(ha),t(ga),t(x),h(W=>{z(xa,"src",(a(o),m(()=>a(o).img))),d(Va,(a(o),m(()=>a(o).name))),d(Wa,(a(o),m(()=>a(o).comment))),d(za,W)},[()=>(a(o),m(()=>new Date(a(o).createdAt).toLocaleDateString()))],Aa),_(c,x)}),_(n,e)};st(Ka,n=>{a(g),m(()=>a(g).length>0)&&n(Na)})}t(da),h(()=>{z(ta,"src",a(w)),d(Da,(a(l),m(()=>a(l).name))),d(Oa,`SKU: ${a(l),m(()=>a(l)._id)??""}`),d(Sa,`$${a(l),m(()=>a(l).price)??""}`),d(Fa,`$${a(l),m(()=>a(l).old_price)??""}`),d(Ia,`4.5 (${a(j)??""} reviews)`),d(La,(a(l),m(()=>a(l).description))),A(ca,1,`bi ${a(u)?"bi-heart-fill text-danger":"bi-heart"}`,"svelte-q5d10x"),d(Ma,` ${a(u)?" Remover dos Favoritos":" Adicionar aos Favoritos"}`),d(Qa,`4.5 (${a(j)??""} reviews)`),d(Ja,`${a(b)??""} estrela(s)`)}),qa(na,()=>a(H),n=>v(H,n)),f("click",oa,Ra),f("click",I,Ca),qa(fa,()=>a(E),n=>v(E,n)),f("submit",Q,Ua),_(ja,Z),Za(),Ta()}export{jt as component};
