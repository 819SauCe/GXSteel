import"../chunks/CWj6FrbW.js";import"../chunks/69_IOA4Y.js";import{s as q,o as ke}from"../chunks/bSBEkUoL.js";import{aB as ge,av as he,a0 as ye,aC as $e,aD as we,ag as ce,o as B,ak as i,al as s,aj as n,ad as x,u as f,q as z,aq as L,b as e,m as b,ah as de,e as p,an as N,ao as Me,ap as Pe,aE as qe,aF as le,a as Oe}from"../chunks/Drqjlocp.js";import{i as pe}from"../chunks/pGr50Ksl.js";import{e as Y,i as Z}from"../chunks/CO5MOPoP.js";import{s as y,r as re,a as Se,b as je}from"../chunks/BtJ7pRuC.js";import{l as Fe,e as ee}from"../chunks/UcTkXPwT.js";import{b as ne}from"../chunks/eoilAeMn.js";import{i as ue}from"../chunks/CJdcSarI.js";import{s as Ve,c as Ce}from"../chunks/DJj6Flok.js";import{p as Ee}from"../chunks/CZaW9bpT.js";/* empty css                */import{L as Le}from"../chunks/ZP2wt5iF.js";function _e(o,d,a){if(o.multiple){if(d==null)return;if(!ye(d))return $e();for(var v of o.options)v.selected=d.includes(H(v));return}for(v of o.options){var c=H(v);if(we(c,d)){v.selected=!0;return}}(!a||d!==void 0)&&(o.selectedIndex=-1)}function Re(o){var d=new MutationObserver(()=>{_e(o,o.__value)});d.observe(o,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),he(()=>{d.disconnect()})}function ve(o,d,a=d){var v=!0;Fe(o,"change",c=>{var k=c?"[selected]":":checked",u;if(o.multiple)u=[].map.call(o.querySelectorAll(k),H);else{var O=o.querySelector(k)??o.querySelector("option:not([disabled])");u=O&&H(O)}a(u)}),ge(()=>{var c=d();if(_e(o,c,v),v&&c===void 0){var k=o.querySelector(":checked");k!==null&&(c=H(k),a(c))}o.__value=c,v=!1}),Re(o)}function H(o){return"__value"in o?o.__value:o.value}var Ae=B('<span class="text-muted text-decoration-line-through ms-2"> </span>'),Ke=B('<i class="bi bi-star-fill text-warning me-1 svelte-ru78kc"></i>'),Te=B('<div class="card card-fixed m-3 svelte-ru78kc"><a><img class="card-img-top svelte-ru78kc"/></a> <div class="card-body svelte-ru78kc"><a><h5 class="card-title svelte-ru78kc"> </h5></a> <p class="card-text svelte-ru78kc" style="font-size: 0.95rem; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden;"> </p> <p class="card-text mb-1 svelte-ru78kc"><span class="text-danger fw-bold svelte-ru78kc"> </span> <!></p> <p class="mb-2 d-flex align-items-center"><!> <span class="text-muted ms-1"> </span></p> <div class="d-flex justify-content-between align-items-center"><a class="btn btn-primary svelte-ru78kc">Comprar</a> <div class="d-flex align-items-center"><button class="like-btn svelte-ru78kc" aria-label="true"><i></i></button> <span class="text-muted ms-2"> </span></div></div></div></div>');function Ne(o,d){ce(d,!1);let a=Ee(d,"product",12),v=b(!1);async function c(){try{const m=await fetch(`https://172.16.0.18:3000/api/like_product/${a().id}`,{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include"});if(!m.ok)throw new Error("Erro ao favoritar produto");const P=await m.json();p(v,!0),a(a().liked+=1,!0)}catch(m){console.error(m),alert("Você precisa estar logado para curtir produtos.")}}ue();var k=Te(),u=i(k),O=i(u);s(u);var $=n(u,2),g=i($),w=i(g),S=i(w,!0);s(w),s(g);var R=n(g,2),h=i(R,!0);s(R);var D=n(R,2),I=i(D),J=i(I);s(I);var Q=n(I,2);{var U=m=>{var P=Ae(),E=i(P);s(P),L(()=>q(E,`R$ ${x(a()),f(()=>a().precoOriginal)??""}`)),z(m,P)};pe(Q,m=>{x(a()),f(()=>a().precoOriginal)&&m(U)})}s(D);var C=n(D,2),A=i(C);Y(A,1,()=>(x(a()),f(()=>Array(Number(a().stars)).fill(0))),Z,(m,P)=>{var E=Ke();z(m,E)});var K=n(A,2),ae=i(K);s(K),s(C);var M=n(C,2),j=i(M),T=n(j,2),F=i(T),G=i(F);s(F);var W=n(F,2),X=i(W);s(W),s(T),s(M),s($),s(k),L(()=>{y(u,"href",`/produto/${x(a()),f(()=>a().id)??""}`),y(O,"src",(x(a()),f(()=>a().imagem[0]))),y(O,"alt",(x(a()),f(()=>a().titulo))),y(g,"href",`/produto/${x(a()),f(()=>a().id)??""}`),q(S,(x(a()),f(()=>a().titulo))),q(h,(x(a()),f(()=>a().descricao))),q(J,`R$ ${x(a()),f(()=>a().preco)??""}`),q(ae,`(${x(a()),f(()=>a().stars)??""})`),y(j,"href",`/produto/${x(a()),f(()=>a().id)??""}`),Ve(G,1,Ce(e(v)?"bi bi-heart-fill":"bi bi-heart")),q(X,`(${x(a()),f(()=>a().liked)??""})`)}),ee("click",F,c),z(o,k),de()}var ze=B('<div style="display: flex; gap: 1rem;"><input type="checkbox"/> <label class="svelte-xskvp"> </label></div>'),Be=B("<option> </option>"),De=B('<h1 class="svelte-xskvp">Nossos produtos</h1> <hr class="svelte-xskvp"/> <main class="svelte-xskvp"><aside class="filtro svelte-xskvp"><h2 class="svelte-xskvp">Filtros</h2> <div class="campo svelte-xskvp"></div> <div class="campo svelte-xskvp"><label for="preco" class="svelte-xskvp"> </label> <input type="range" class="svelte-xskvp"/> <input type="range" class="svelte-xskvp"/></div> <div class="campo svelte-xskvp"><label for="estrelas" class="svelte-xskvp">Mínimo de avaliações</label> <select class="svelte-xskvp"><option>Todas</option><!></select></div> <div class="campo svelte-xskvp"><label for="ordenar" class="svelte-xskvp">Ordenar por</label> <select class="svelte-xskvp"><option>--</option><option>Mais curtidos</option><option>Mais vendidos</option><option>Menos vendidos</option></select></div></aside> <div class="vitrine svelte-xskvp"><!> <!></div></main>',1);function sa(o,d){ce(d,!1);const a=b(),v=b(),c=b(),k=b();let u=b([]),O=b(!1),$=b(e(v)),g=b(e(c)),w=b(""),S=b(""),R=b([]),h=b([]);function D(t){e(h).includes(t)?p(h,e(h).filter(l=>l!==t)):p(h,[...e(h),t])}function I(t){return e(S)==="curtidos"?[...t].sort((l,r)=>(r.liked||0)-(l.liked||0)):e(S)==="maisVendidos"?[...t].sort((l,r)=>(r.sells||0)-(l.sells||0)):e(S)==="menosVendidos"?[...t].sort((l,r)=>(l.sells||0)-(r.sells||0)):t}ke(async()=>{const l=await(await fetch("https://172.16.0.18:3000/api/products?page=1&limit=20")).json();p(O,!0),p(u,l.map(r=>{var _;return{id:r._id,preco:r.price,precoOriginal:r.old_price,titulo:r.name,descricao:r.description,stars:((_=r.ratings)==null?void 0:_.length)||0,liked:r.liked||0,sells:r.sells||0,filtro:r.category||"",imagem:r.image||"",category:r.category}})),p(R,[...new Set(e(u).map(r=>r.category))]),await qe(),document.querySelectorAll('input[type="range"]').forEach(r=>{const _=(r.value-r.min)/(r.max-r.min)*100;r.style.setProperty("--value",`${_}%`)})}),N(()=>e(u),()=>{p(a,e(u).map(t=>t.preco||0))}),N(()=>e(a),()=>{p(v,Math.min(...e(a)))}),N(()=>e(a),()=>{p(c,Math.max(...e(a)))}),N(()=>e(v),()=>{p($,e(v))}),N(()=>e(c),()=>{p(g,e(c))}),N(()=>(e(u),e(w),e($),e(g),e(h)),()=>{p(k,I(e(u).filter(t=>{const l=!e(w)||t.stars>=+e(w),r=t.preco>=e($)&&t.preco<=e(g),_=e(h).length===0||e(h).every(V=>t.filtro.toLowerCase().includes(V));return l&&r&&_})))}),Me(),ue();var J=De(),Q=n(Pe(J),4),U=i(Q),C=n(i(U),2);Y(C,5,()=>e(R),Z,(t,l)=>{var r=ze(),_=i(r);re(_);var V=n(_,2),xe=i(V,!0);s(V),s(r),L(be=>{y(_,"id",e(l)),Se(_,e(l)),je(_,be),y(V,"for",e(l)),q(xe,e(l))},[()=>(e(h),e(l),f(()=>e(h).includes(e(l))))],Oe),ee("change",_,()=>D(e(l))),z(t,r)}),s(C);var A=n(C,2),K=i(A),ae=i(K);s(K);var M=n(K,2);re(M);var j=n(M,2);re(j),s(A);var T=n(A,2),F=n(i(T),2);L(()=>{e(w),le(()=>{})});var G=i(F);G.value=G.__value="";var W=n(G);Y(W,0,()=>[1,2,3,4,5],Z,(t,l)=>{var r=Be(),_=i(r);s(r);var V={};L(()=>{q(_,`${l??""} estrela${l>1?"s":""}`),V!==(V=l)&&(r.value=(r.__value=l)??"")}),z(t,r)}),s(F),s(T);var X=n(T,2),m=n(i(X),2);L(()=>{e(S),le(()=>{})});var P=i(m);P.value=P.__value="";var E=n(P);E.value=E.__value="curtidos";var te=n(E);te.value=te.__value="maisVendidos";var se=n(te);se.value=se.__value="menosVendidos",s(m),s(X),s(U);var ie=n(U,2),oe=i(ie);Y(oe,1,()=>e(k),Z,(t,l)=>{Ne(t,{get product(){return e(l)}})});var me=n(oe,2);{var fe=t=>{Le(t)};pe(me,t=>{e(O)||t(fe)})}s(ie),s(Q),L(()=>{q(ae,`Preço: R$ ${e($)??""} – R$ ${e(g)??""}`),y(M,"min",e(v)),y(M,"max",e(c)),y(j,"min",e(v)),y(j,"max",e(c))}),ne(M,()=>e($),t=>p($,t)),ee("input",M,t=>t.target.style.setProperty("--value",(e($)-e(v))/(e(c)-e(v))*100+"%")),ne(j,()=>e(g),t=>p(g,t)),ee("input",j,t=>t.target.style.setProperty("--value",(e(g)-e(v))/(e(c)-e(v))*100+"%")),ve(F,()=>e(w),t=>p(w,t)),ve(m,()=>e(S),t=>p(S,t)),z(o,J),de()}export{sa as component};
